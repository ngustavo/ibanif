<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ibanif</title>
</head>

<body>
    <label>
        <input type="text" id="iban_in">
    </label>
    <div id="iban_out"></div>
    <button id="iban_gen"></button>
    <label>
        <input type="text" id="nif_in">
    </label>
    <div id="nif_out"></div>
    <button id="nif_gen"></button>

    <script>
        const getNIF = (from = .1, to = .3) => { // 1xx xxx xxx - 3xx xxx xxx
            const random = getRandomInt(from * 100000000, to * 100000000 - 1).toString();
            let total = 0;

            for (let i = 0; i < 8; i++) {
                total += parseInt(random[i]) * (9 - i);
            }

            const checkDigit = (11 - (total % 11)) % 11;
            const nif = random + (checkDigit > 9 ? 0 : checkDigit);
            return nif;
        }

        const getIBAN = (prefix = "0007") => { // PT50 0007 xxx xxx xxx xxx xxx xx
            const min = 1e14;
            const max = 1e15 - 1;
            const random = `${prefix}${getRandomInt(min, max)}`;
            const nib1 = random.toString();

            let result = 0;
            for (let nibIndex = 0; nibIndex < 19; nibIndex++) {
                result = ((result + parseInt(nib1[nibIndex])) * 10) % 97;
            }

            const checkDigit = `${98 - ((result * 10) % 97)}`.padStart(2, "0");
            const nib = `${random}${checkDigit}`;

            return `PT50${nib}`;
        }

        document.querySelector("#iban_gen").addEventListener("click", () => {
            document.querySelector("#iban_out").innerHTML = getIBAN();
        });

        document.querySelector("#nif_gen").addEventListener("click", () => {
            document.querySelector("#nif_out").innerHTML = getNIF();
        });
    </script>
</body>

</html>